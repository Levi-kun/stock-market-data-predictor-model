{% extends "base.html" %}

{% block title %}
Feedback - My Flask App
{% endblock %}

{% block content %}
<div class="feedback-container">

    <!-- Header -->
    <div class="feedback-header">
        <h1>We Value Your Feedback</h1>
        <p>Let us know your thoughts or report issues.</p>
    </div>

    <!-- Feedback Form -->
    <div class="feedback-form">
        <form method="POST" action="{{ url_for('main.feedback') }}">

            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" placeholder="Your name" required>
            </div>

            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" placeholder="Your email" required>
            </div>

            <div class="form-group">
                <label for="message">Feedback</label>
                <textarea id="message" name="message" rows="5" placeholder="Your feedback..." required></textarea>
            </div>

            <button type="submit" onclick="sendRequets()">Submit Feedback</button>
        </form>
    </div>

    <div class="acknoledge"> </div>

</div>
{% endblock %}


<script>
async function sendRequets() {
    const ack = document.querySelector(".acknoledge");

    // 1. Try to grab the form (if it exists in the block)
    const form = document.querySelector("form");

    // 2. Use form action OR fallback to current page route
    const url = form?.action || window.location.pathname;

    try {
        const res = await fetch(url, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({})  // or your fields
        });

        const data = await res.json();

        if (data.success === true) {
            ack.textContent = "Success!";
            ack.style.color = "green";
        } else {
            ack.textContent = "Error: Something went wrong.";
            ack.style.color = "red";
        }

    } catch (err) {
        ack.textContent = "Network error.";
        ack.style.color = "red";
    }
}
</script>
